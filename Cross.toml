#############################################
# cross configuration for Linux targets
#############################################

[build.env]
# Pass through env to allow pkg-config in cross and avoid vendoring
passthrough = ["PKG_CONFIG_ALLOW_CROSS", "OPENSSL_NO_VENDOR"]

[target.x86_64-unknown-linux-gnu]
pre-build = [
  # Install system OpenSSL for native GNU target
  "apt-get update",
  "apt-get install -y --no-install-recommends pkg-config libssl-dev ca-certificates",
  "update-ca-certificates"
]

[target.aarch64-unknown-linux-gnu]
pre-build = [
  # Enable multi-arch and install aarch64 OpenSSL dev headers
  "dpkg --add-architecture arm64",
  "apt-get update",
  "apt-get install -y --no-install-recommends pkg-config libssl-dev:arm64 ca-certificates",
  "update-ca-certificates"
]

